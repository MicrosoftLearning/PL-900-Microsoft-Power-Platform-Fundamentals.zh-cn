---
lab:
  title: 实验室 4：如何构建自动解决方案
  module: 'Module 4: Get Started with Power Automate'
---

# 实验室 4：如何构建自动解决方案

**WWL 租户 - 使用条款** 如果在讲师引导式培训过程中向你提供租户，请注意，提供租户的目的是支持讲师引导式培训中的动手实验室。 租户不应共享或用于动手实验室以外的用途。 本课程使用的租户为试用租户，课程结束后将无法使用或访问，并且不符合延期条件。 租户不得转换为付费订阅。 在本课程中获得的租户仍然是 Microsoft Corporation 的财产，我们保留随时获取访问权限和收回的权利。 

## 场景

Bellows College 是一所教育机构，拥有多个校园并开设有多门课程。 许多 Bellows College 的讲师和管理员都需要参加活动，并购买项目。 从以往看来，跟踪这些费用并非易事。 

校园管理层希望通过向员工提供一种报告费用的数字方式，以实现费用报告系统的现代化。 

在整个课程中，你将构建应用程序并执行自动化，使 Bellows College 员工能够管理费用。 

在此实验室中，你将创建一个 Power Automate 流，以便在他们创建新的费用报告时通过电子邮件发送费用报告的副本。

## 概要实验室步骤

以下已被确定为完成项目必须满足的要求：

- 提交费用报告时，员工需要收到一封电子邮件。 

### 先决条件

- 完成“模块 1 实验室 0 - 验证实验室环境”****

## 练习 1：创建费用报告通知流

**目的：** 在本练习中，你将创建一个实现要求的 Power Automate 流。 

### 任务 #1：创建流

1. 导航到 https://make.powerapps.com

1. 你可能需要重新进行身份验证，请选择“登录”并根据需要按照说明进行操作****。

1. 选择右上角的“Dev One”环境（如果尚未选择）。****

1. 在左侧导航栏中，选择“流”。

1. 如果出现提示，请选择“开始”。

1. 选择“+ 新建流”，然后选择“自动化的云端流” 。

1. 输入“费用通知”作为流名称。****

1. 在“选择流的触发器”中，搜索 Dataverse****

1. 选择触发器“添加、修改或删除行时”，然后选择“创建”。********

1. 填充流的触发条件：

    1. 为“更改类型”选择“已添加”
    
    1. 选择“费用报告”作为表名称********

    1. 为“范围”选择“组织”

    1. 在触发步骤上，选择省略号 (…)，然后选择“重命名” 。 将触发器步骤重命名为 `When an Expense Report is added` 

这是一个很好的习惯，这样你和其他流编辑可以理解步骤的目的，而不必深入研究细节。

### 任务 #2：创建获取“费用报告”行的步骤

1. 选择“+新建步骤”。 此步骤将检索支出报表信息，包括电子邮件地址。

1. 搜索 Dataverse

1. 选择“按 ID 获取行”操作。

1. 选择“用户”作为表名称********

1. 选择“行 ID”字段。 请注意，此时会弹出一个窗口，用于选择“动态内容”或“表达式” 。

1. 在“行 ID”字段中，从“动态内容”列表中选择“所有者(值)”。************ 在此步骤中，你将查找创建的“费用报告的所有者”行来触发此流。 

1. 在“按 ID 获取行”操作上，选择省略号 (...)，然后选择“重命名”  。 将此操作重命名为“获取所有者”

这是一个很好的习惯，这样你和其他流编辑可以理解步骤的目的，而不必深入研究细节。

### 任务 3：创建一个发送电子邮件以确认提交支出报表的步骤

1. 选择“+新建步骤”。 此步骤将向提交支出报表的人员发送电子邮件。

1. 搜索邮件，从“Office 365 Outlook”连接器中选择“发送电子邮件(V2)”操作。********

1. 如果提示接受使用此操作的条款和条件，请选择“接受”。

1. 选择“收件人”字段并输入个人电子邮件地址。**** （可通过多种方式动态填充电子邮件地址，但在本练习中，我们将手动分配它。）  

1. 在“主题”字段中，输入已提交的费用报告****

1. 在“电子邮件正文”中输入以下文本：

需将动态内容置于方括号中命名字段的位置。 建议先复制并粘贴所有文本，然后在正确的位置添加动态内容。

    Dear {First Name},
    
    Thank you for submitting your expense report for the total amount of {Report Total Amount} with a due date of {Report Due Date}.
    
     
    Best regards,
    Campus Administration
    Bellows College

1. 突出显示 {First Name} 文本。 将此文本替换为“获取所有者”步骤中的“名字”字段。********

1. 突出显示 {报告总金额} 文本。**** 将其替换为“提交支出报表时”步骤中的“报表总金额”字段。********

1. 突出显示 {报告截止日期} 文本。**** 将其替换为“提交支出报表时”步骤中的“报表截止日期”字段。********

1. 选择“保存”。

将此流选项卡保持打开状态以用于下一个任务。 流应如下所示：

![刚刚创建的流的屏幕截图](media/lab-4-create-an-automated-solution-01.png)

### 任务 #4：验证并测试流

1. 在浏览器中打开新的标签页，然后导航到 https://make.powerapps.com

1. 选择右上角的“Dev One”环境（如果尚未选择）。****

1. 选择“应用”并打开“费用跟踪器应用”。********

1. 保持此浏览器标签页处于打开状态，然后导航回到流的上一个选项卡。

1. 在命令栏上，选择“测试”。 选择“手动”，然后选择“测试” 。

1. 导航到打开了模型驱动应用的浏览器标签页。

1. 使用左侧的站点地图导航选择“费用报告”。****

1. 选择“+ 新建”按钮，添加新的“费用报告”记录。********

1. 填写费用报告记录，如下所示：****

    - **报告名称：** 测试报告

    - **报告截止日期：** 明天 

1. 选择**保存并关闭**按钮。

1. 导航到正在运行流测试的浏览器标签页。 在短暂的延迟之后，你应该会看到流正在运行。 你可以在这里发现流中的任何问题，或确认它已成功运行。

短暂延迟后，应该会在收件箱中看到电子邮件。 

>**注意：** 该邮件可能放在“垃圾邮件”文件夹中。
