---
lab:
  title: 实验室 3：如何构建模型驱动的应用
  module: 'Module 3: Get started with Power Apps'
---

# 实验室 3：如何构建模型驱动的应用

**WWL 租户 - 使用条款** 如果在讲师引导式培训过程中向你提供租户，请注意，提供租户的目的是支持讲师引导式培训中的动手实验室。 租户不应共享或用于动手实验室以外的用途。 本课程使用的租户为试用租户，课程结束后无法使用或访问，不符合扩展条件。 租户不得转换为付费订阅。 在本课程中获得的租户仍然是 Microsoft Corporation 的财产，我们保留随时获取访问权限和收回的权利。 

## 方案

Bellows College 是一所教育机构，校园内有多座建筑。 当前，校园访客被记录在纸质日记中。 无法始终如一地捕获信息，也无法收集和分析有关整个校园的访问数据。

校园管理部门希望对其访客登记系统进行现代化改造。在该系统中，由安全人员控制对建筑物的访问，所有访问都必须由主办人预先登记和记录。

在整个课程中，你将生成应用程序并执行自动化，以使 Bellows College 的管理和安全人员可以管理和控制校园建筑的出入情况。

在本实验室中，你将生成一个 Power Apps 模型驱动应用，以允许后台办公室的校园工作人员管理整个校园的访问记录。

## 概要实验室步骤

作为创建模型驱动应用的一部分，你将完成以下操作：

- 新建一个名为“Bellows 校园管理”的模型驱动应用

- 编辑应用导航以引用所需的表

- 自定义应用所需表的表单和视图

我们将使用以下组件：

- **视图**：视图允许用户显示表单表中的现有数据。

- **窗体**：用户在此处创建/更新表中的新记录。

两者都将集成到模型驱动应用中，以提供更好的用户体验。

## 先决条件

- 完成“模块 0 实验室 0 - 验证实验室环境”

- 完成“模块 2 实验室 1 - 数据建模”

开始前要考虑的事项

- 应该进行哪些更改以改善用户体验？

- 基于我们生成的数据模型，我们应该在模型驱动应用中包括哪些内容？

- 可以在模型驱动应用的网站图上进行哪些自定义？

## 练习 1：自定义视图和表单

**目的：** 在本练习中，你将自定义将在模型驱动应用中使用的自定义创建表的视图和表单。

### 任务 #1：编辑访问表单

1.  登录到 <https://make.powerapps.com>（如果尚未登录）。

2.  如果尚未选择“[我的初始] 练习”环境，请在右上角选择它。

3.  使用左侧的导航，选择“表”，然后打开“访问”表 。

    如果未看到“访问”表，请确保位于正确的环境中（步骤 2）。

4.  在“数据体验”部分下，选择“窗体”，然后打开窗体类型为“Main”的信息窗体   。 （重要提示：请确保选择窗体类型为“Main”的窗体。） 

> **重要提示：** 由于默认情况下所有表单都称为“信息”，因此请确保验证所选表单的表单类型为“主要”而不是其他类型。 表单默认有两个字段：“名称”和“所有者”。

5.  在屏幕右侧的“属性”面板中，选择“显示名称”字段，并将其更改为 `Main Information`

6.  从左侧导航窗格中选择“表列”，在“所有者”字段下添加以下字段，方法是将列拖动到窗体或单击列名称：

    1. **访问者**

    2. **计划开始日期**

    3. **计划结束日期**

    4. **** 实际开始日期

    5. **** 实际结束日期

7.  拖动“代码”列并将其拖到表单页眉处。

    标题是表单的右上角区域。 你可能需要折叠屏幕右侧的“属性”面板才能看到表单上的字段。

8.  在“代码”字段仍处于选中状态时，选中屏幕右侧“属性”面板中的“只读字段”复选框 。

9.  选择“所有者”字段。 在“属性”面板中将“标签”更改为 `Host`

10. 选择右上角的“保存并发布”按钮，等待直到保存并发布完成。

11. 如果在新的浏览器标签页或窗口中打开了“编辑”视图，请将其关闭。 否则，选择屏幕左上方的“🡠 返回”。 现在，你应返回到“访问”表的窗体。

12. 使用左上角的痕迹导航（“表” > “访问” > “窗体”）  。 选择“访问”以返回到“访问”表的“属性”屏幕 。 


### 任务 #2：编辑“活跃访问”视图

在此任务中，我们将修改默认的“活动访问”视图并为今天的访问新建视图。

1.  在“数据体验”部分下，选择“视图”，然后打开“活动访问”视图  。

2.  通过单击或拖放字段，将以下字段添加到视图中：

    1. **代码**

    2. **访问者**

    3. **计划开始日期**

    4. **计划结束日期**

3.  选择“创建时间”列上的下拉菜单，然后选择“删除” 。 现在将从视图中删除“创建时间”字段。

4.  根据需要重设各个列的宽度以适应数据。

5.  在“排序依据...”下， 选择“X”以删除“名称”，改为选择“计划启动” 。

6.  选择“计划启动”，将排序顺序更改为“从新到旧” 。

7.  选择右上角的“保存并发布”按钮，等待直到发布完成。


### 任务 3：为今天的访问新建视图

现在我们将克隆视图，来为今天的访问创建一个新视图。

> **重要提示：** 请确保你未关闭“活动访问”视图，因为我们将利用它创建新的“今日访问”视图。

1.  选择“另存为”。

2.  将“名称”更改为 `Today’s Visits`，然后选择“保存” 。

3.  在“属性”面板中选择“编辑筛选器”。

4.  选择“+ 添加”，然后选择“添加行” 。

5.  选择“计划开始时间”作为字段，然后在下拉菜单中将“等于”更改为“今天”作为条件  。

6.  选择 “状态”行上的“... 更多命令”，然后选择“删除”以删除该筛选条件  。

7.  选择“确定”以保存该条件。 视图现已经过筛选，仅显示计划开始日期为今天的记录。

8.  在视图中添加“实际开始时间”和“实际结束时间”字段。

> **注意：** 由于我们不再筛选视图状态，因此我们将获得今天所有的访问，包括已完成的访问。 这些字段有助于区分完成的访问和进行中的访问。

9.  选择右上角的“保存并发布”按钮，等待直到发布完成。


## 练习 2：创建模型驱动应用

目的：在本练习中，你将创建模型驱动应用、自定义站点地图并测试该应用。

为简单起见和节约时间，我们将不讨论本实验室中的一些访问列。

### 任务 #1：创建应用

1.  登录到 <https://make.powerapps.com>（如果尚未登录）。

2.  如果尚未选择“[我的姓名首字母] 练习”**** 环境，请在右上角选择它。

3.  在左侧导航上，选择“+ 创建”。

4.  创建模型驱动应用程序：

    1. 在“创建应用”屏幕的“开始”部分中选择“空白应用”  。

    2. 在“基于 Dataverse 的空白应用”下，选择“创建” 。

    3. 输入 `Bellows Campus Management` 作为名称，然后选择“创建” 。

5.  加载新的模型驱动应用程序后，选择“+ 添加页面”按钮。

6.  在“添加页面”屏幕上，选择“Dataverse 表”，然后选择“下一步”按钮  。

7.  选择下表：

    1. 访问

    2. 联系人

8.  拥有这两个表后，选择“添加”。

9.  使用屏幕左侧的导航图标，选择“导航”。

10. 在导航窗格上，选择下方显示“导航”的“新建组”。 可能需要展开左侧的菜单。

11. 在屏幕右侧的“显示选项”部分，将“标题”属性更改为 `Security`

12. 选择“保存”，然后等待更改保存完毕。

13. “保存”完成后，选择“发布”按钮发布所做的更改 。


### 任务 #2：测试应用

启动应用程序

1. 选择“播放”按钮，模型驱动应用将在新选项卡中加载。

创建新联系人

2.  应用应该会打开“我的可用联系人”视图。 如果未打开，请选择左侧导航中的“联系人”。

3.  从命令栏中选择“+ 新建”。

4.  在“名字”中输入 `John`，并在“姓氏”中输入 `Doe`

5.  在“电子邮件”中输入你的个人电子邮件。 这将在将来的实验室中使用，你将收到一封电子邮件。

6.  选择**保存并关闭**。

7.  现在应该可以在“我的可用联系人”视图中看到已创建的联系人。

创建新的访问

8.  从左侧导航（也称为站点地图）中，选择“访问”。

9.  选择 **+ 新建**。

10. 按照如下所示输入字段信息：

    1. **名称**：`New test visit`

    2. 访客：选择“John Doe”

    3. 计划开始时间：选择明天的日期和下午 2:00 作为开始时间

    4. 计划结束时间：选择明天的日期和下午 3:30 作为结束时间

11. 选择**保存并关闭**。 这将创建访问，并且你应该可以在“活动访问”视图上看到它。

12. 使用“活动访问”旁边的下拉列表，将视图更改为“今日访问” 。 由于新访问安排在明天，因此视图中不再显示该访问。

13. 可以添加更多测试记录。

正在运行的模型驱动应用看上去大致如下图所示：

![](media/3-model-driven-app.png)

祝贺你！ 你已创建并配置了第一个模型驱动的应用。

## 挑战

- 为联系人选择特定的视图和表单。

