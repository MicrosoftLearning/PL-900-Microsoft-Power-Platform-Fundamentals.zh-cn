---
lab:
  title: 实验室 1：数据建模
  module: 'Module 2: Introduction to Microsoft Dataverse'
---

# 实验室 1：数据建模

**WWL 租户 - 使用条款** 如果在讲师引导式培训过程中向你提供租户，请注意，提供租户的目的是支持讲师引导式培训中的动手实验室。 租户不应共享或用于动手实验室以外的用途。 本课程使用的租户为试用租户，课程结束后无法使用或访问，不符合扩展条件。 租户不得转换为付费订阅。 在本课程中获得的租户仍然是 Microsoft Corporation 的财产，我们保留随时获取访问权限和收回的权利。 

## 方案

Bellows College 是一所教育机构，校园内有多座建筑。 目前，校园访问记录在纸质日报上。 无法始终如一地捕获信息，也无法收集和分析有关整个校园的访问数据。

校园管理部门希望对其访客登记系统进行现代化改造。在该系统中，由安全人员控制对建筑物的访问，所有访问都必须由主办人预先登记和记录。

在整个课程中，你将生成应用程序并执行自动化，以使 Bellows College 的管理和安全人员可以管理和控制校园建筑的出入情况。

此实验室将创建一个数据模型来满足以下要求：

- R1 - 跟踪计划校园访问的信息。

- R2 - 记录基本信息以识别和跟踪访问者。

- R3 - 安排、记录和管理访问。

最后，你将示例数据导入 Microsoft Dataverse。

概要实验室步骤

为了准备学习环境，你将：

- 请参阅[数据模型文档](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/blob/master/Allfiles/Campus%20Management.png)以获取元数据说明（表和关系）。 你可以按住 Ctrl 键单击或右键单击链接以在新窗口中打开数据模型文档。
- 创建 Visit 表
- 使用 Excel 电子表格导入 Visit 数据


## 先决条件

- 完成“模块 0 实验室 0 - 验证实验室环境”

开始前要考虑的事项

- 命名约定 - 仔细键入名称。

# 练习 1：创建新表

**目的：** 在本练习中，你将为访问创建新的自定义表。

## 任务 #1：创建 Visit 表和列

“访问”表将包含有关校园访问的信息，包括访客、每次访问的计划时间和实际时间。

我们希望为每次访问分配一个唯一的号码，当访客在访问签到过程中被询问时，他/她可以很容易地输入并解释该号码。

1.  登录到 <https://make.powerapps.com>（如果尚未登录） 

1.  在右上角的“环境”菜单中，确保已选择“实践”环境 。 

1.  使用左侧导航栏，选择“表”。

1.  选择“+新建表”，然后选择“设置高级属性”。 

1.  在“显示名称”中输入 `Visit`

1.  选择“保存”。 

1.  在“架构”部分下，选择“列”。 


## 创建“计划开始时间”列

1.  选择“+ 新建列”。 

1.  在“显示名称”中输入 `Scheduled Start`。 

1.  为“数据类型”选择“日期和时间” 。 

1.  将“必需”更改为“业务必需” 。 

1.  展开“高级选项”。 

1.  在“时区调整”中，选择“与时区无关”。 

    > 注意：我们用“与时区无关”行为来记录日期和时间信息，因为访问时间始终与建筑物所在的本地时间一致，因此当从不同时区查看时，不应更改此信息 。 

1.  选择“保存”。 


## 创建“计划结束时间”列

1.  选择“+ 新建列”。 

1.  在“显示名称”中输入 `Scheduled End`。

1.  为“数据类型”选择“日期和时间” 。

1.  在“必填”字段中，选择“必需业务” 。

1.  展开“高级选项”。

1.  在“时区调整”中，选择“与时区无关”。

1.  选择“保存”。 


## 创建“实际开始时间”列

1.  选择“+ 新建列”。 

1.  在“显示名称”中输入 `Actual Start`。

1.  为“数据类型”选择“日期和时间” 。

1.  在“必填”字段中，将其保留为“可选”。

1.  展开“高级选项”。

1.  在“时区调整”中，选择“与时区无关”。 

1.  选择“保存”。 


## 创建“实际结束时间”列

1.  选择“+ 新建列”。

1.  在“显示名称”中输入 `Actual End`。

1.  为“数据类型”选择“日期和时间” 。

1.  在“必填”字段中，将其保留为“可选”。

1.  展开“高级选项”。

1.  在“时区调整”中，选择“与时区无关”。

1.  选择“保存”。


## 创建代码列

1.  选择“+ 新建列”。

1.  在“显示名称”中输入 `Code`。

1.  为“数据类型”选择“自动编号” 。

1.  为“自动编号类型”选择“带日期前缀的数字”。

1.  选择“保存”。 


## 创建访客查找列

1.  选择“+ 新建列”。

1.  在“显示名称”中输入 `Visitor`。

1.  选择“查找” > “查找数据类型”  。 

1.  为“相关表”选择“联系人” 。 

1.  展开“高级选项”。 

1.  在“关系名称”中输入 `visitor_id`。 

1.  选择“保存”。


# 练习 2：导入数据

**目的：** 在本练习中，你要将示例数据导入 Dataverse 数据库。

## 任务 \#1：将 Excel 文件加载到 OneDrive

1.  应将 Visits.xlsx 文件存储在 C:/LabFiles 中的虚拟机上。 如果不这样做，请下载 [Visits.xlsx](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/raw/master/Allfiles/Visits.xlsx)。

2.  如果尚未登录，请登录 [https://make.powerapps.com](https://make.powerapps.com/)。 

3.  如果尚未选择“[我的初始] 练习”环境，请在右上角选择它。

4.  选择左上角的“Waffle”按钮以更改应用程序，然后选择“OneDrive”。 （设置 OneDrive 可能需要一些时间。 在屏幕上看到“OneDrive 已准备就绪”时，选择它。）

5.  从菜单中选择“+添加新项”，然后选择“文件上传”。

6.  找到并选择 Visits.xlsx 文件，然后选择“打开” 。

    > 注意：该文件应位于虚拟机上的“桌面” > “所有文件”文件夹中。


## 任务 \#2：创建数据流

1.  登录到 <https://make.powerapps.com>（如果尚未登录） 

2.  在右上角的“环境”菜单中，确保已选择“实践”环境 。 

3.  使用左侧导航栏，选择“表”。 

4.  打开在上一个练习中创建的 Visit 表。 

5.  使用顶部的菜单，选择“导入”>“导入数据” > 。

6.  在“选择数据源”对话框中，选择“Excel 工作簿”。

7.  选择“链接到文件”选项。 单击“浏览 OneDrive”。 如果出现系统提示，请使用你的 Microsoft 365 凭据登录。 将浏览器配置为始终允许弹出窗口。 

8.  选择在上一个任务中上传到 OneDrive 的 Visits.xlsx 文件。 

9.  选择**下一步**。 

10. 在“Power Query” > “选择数据”屏幕上，查看 Excel 工作簿“访问”  。 

11. 选择**下一步**。 不要离开此页面。

12. 选择“**下一页**”。 

13. 在“映射表”部分的“加载设置”下，选择“加载到现有表”  。 

14. 在“目标表”下拉菜单中，选择 crXXX_Visit 表（其中，XXX 是一组随机字母和数字）

15. 在“列映射”部分，将各列映射到其相应的目标列：

    | 目标列  | 源值   |
    |:---------------------|:----------------|
    | crxxx_ActualEnd      | actual end      |
    | crxxx_ActualStart    | actual start    |
    | crxxx_Code           | code            |
    | crxxx_Name           | name            |
    | crxxx_ScheduledEnd   | scheduled end   |
    | crxxx_ScheduledStart | scheduled start |

16. 选择“**下一页**”。 

17. 选择“手动刷新”。 

18. 选择“发布”。 

    > **注意：** 将数据导入表可能需要几分钟时间。 如果遇到一些错误，请不要担心，这是正常的，不会影响课程的其余部分。


## 任务 \#3：验证数据导入

1.  导入数据后，使用屏幕左侧的导航选择“表”，然后打开 Visit 表 。

2.  验证是否可在“访问列和数据”部分下看到导入的数据。

恭喜，你已成功创建新表并导入了数据。

