---
lab:
  title: 实验室 1：数据建模
  module: 'Module 2: Introduction to Microsoft Dataverse'
ms.openlocfilehash: 05d0f0656ae0d93f5666f7c14602c3976a9a9ac9
ms.sourcegitcommit: ef58c858463b890e923ef808b1d43405423943fd
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/27/2022
ms.locfileid: "137898790"
---
# <a name="module-2-introduction-to-microsoft-dataverse"></a>模块 2：Microsoft Dataverse 简介

# <a name="scenario"></a>方案

Bellows College 是一所教育机构，校园内有多座建筑。 目前，校园访问记录在纸质日报上。 无法始终如一地捕获信息，也无法收集和分析有关整个校园的访问数据。 

校园管理部门希望对其访客登记系统进行现代化改造。在该系统中，由安全人员控制对建筑物的访问，所有访问都必须由主办人预先登记和记录。

在整个课程中，你将生成应用程序并执行自动化，以使 Bellows College 的管理和安全人员可以管理和控制校园建筑的出入情况。 

在本实验室中，你将访问环境，创建 Microsoft Dataverse 数据库并创建跟踪更改情况的解决方案。 你还将创建一个数据模型来满足以下要求：

-   R1 – 跟踪校园访问的位置（建筑物）
-   R2 - 记录基本信息以识别和跟踪访问者 
-   R3 - 安排、记录和管理访问 

最后，你将示例数据导入 Microsoft Dataverse。

# <a name="high-level-lab-steps"></a>概要实验室步骤

为了准备学习环境，你将：

* 创建解决方案和发布者
* 添加满足应用程序要求所需的新组件和现有组件。 请参阅[数据模型文档](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/blob/master/Allfiles/Campus%20Management.png)以获取元数据说明（表和关系）。 你可以按住 Ctrl 键单击或右键单击链接以在新窗口中打开数据模型文档。

完成所有自定义后，解决方案将包含几个表：

-   联系人
-   生成
-   访问

## <a name="prerequisites"></a>先决条件：

* 完成“模块 0 实验室 0 - 验证实验室环境”

## <a name="things-to-consider-before-you-begin"></a>开始前要考虑的事项：

* 命名约定

* 数据类型、限制（例如，名称的最大长度）

* 日期/时间格式支持轻松本地化

# <a name="exercise-1-create-solution"></a>练习 \#1：创建解决方案

## <a name="task-1-create-solution-and-publisher"></a>任务 \#1：创建解决方案和发布者

1.  创建解决方案

    -   导航到 <https://make.powerapps.com>。 你可能需要重新进行验证身份 - 单击“登录”并根据需要按照说明进行操作。

    -   通过单击屏幕右上角的“环境”，然后从下拉菜单中选择你的环境来选择环境。

    -   从左侧菜单中选择“解决方案”，然后单击“新解决方案”。

    -   在“显示名称”中输入“[你的姓氏] 校园管理”。

2.  创建发布服务器

    -   在“发布者”部分中，选择“+ 发布者”

    -   在弹出的窗口中，在“显示名称”部分输入“Bellows College” 。 

    -   在“名称”部分输入“BellowsCollege” 。
    
    -   在“前缀”中输入“bc” 

    -   单击“保存” 
    
    -   在弹出窗口中单击“完成”。

3.  完成解决方案的创建。

    -   现在，单击“发布者”下拉菜单，然后选择刚刚创建的“Bellows College”发布者 。

    -   验证“版本”是否设置为“1.0.0.0”。 
    
    -   单击“创建”。

# <a name="exercise-2-add-existing-and-create-new-tables"></a>练习 \#2：添加现有表并创建新表

**目的：** 在本练习中，你将添加标准 Contact 表并在解决方案中为 Buildings 和 Visits 创建新的自定义表。 

## <a name="task-1-add-existing-table"></a>任务 \#1：添加现有表

1.  单击以打开你刚刚创建的“校园管理”解决方案。

2.  单击“添加现有”，然后选择“表”。

3.  找到“联系人”并选择它。

4.  单击“下一步”。

5.  单击“联系人”下的“选择组件”。

6.  选择“视图”选项卡，然后选择“活动联系人”视图 。 单击“添加”。
    
7.  请再次点击“选择组件”。

8.  选择“表单”选项卡，然后选择“联系人”表单 。
    
9.  单击“添加”。

    > 你应选择“1 个视图”和“1 个表单” 。 
    
10.  重新单击“添加”。 这会将具有选定视图和表单的 Contact 表添加到新创建的解决方案中。

> 你的解决方案现在应具有一个表：联系人。
    
## <a name="task-2-create-building-table"></a>任务 #2：创建 Building 表

1.  你仍应打开浏览器以访问“校园管理”解决方案。 如果不这样做，请按照以下步骤打开“校园管理”解决方案：

    * 登录到 <https://make.powerapps.com>（如果尚未登录）
    
    * 选择“解决方案”并单击，以打开刚刚创建的“[姓氏] 校园管理”解决方案 。
          
2.  创建 Building 表

    -   单击“新建”，然后选择“表”。
    
    -   为“显示名称”输入“建筑物” 
    
    -   单击“保存”  。 这将开始在后台预配表，同时可以开始添加其他表和列。

## <a name="task-3-create-visit-table-and-columns"></a>任务 3：创建 Visit 表和列

“Visit”表将包含有关校园访问的信息，包括建筑物、访问者、每次访问的计划时间和实际时间。 

我们希望为每次访问分配一个唯一的号码，当访客在访问签到过程中被询问时，他/她可以很容易地输入并解释该号码。

> 我们用“时区无关”行为记录日期和时间信息，因为访问时间始终与建筑物所在位置的本地时间一致，因此当从不同时区查看时，不应更改此信息。 

1.  你仍应打开浏览器以访问“校园管理”解决方案。 如果不这样做，请按照以下步骤打开“校园管理”解决方案：

    * 登录到 <https://make.powerapps.com>（如果尚未登录）
    
    * 选择“解决方案”并单击，以打开刚刚创建的“[姓氏] 校园管理”解决方案 。

2. 创建 Visit 表

   * 单击“新建”，然后选择“表”。
   
   * 为“显示名称”输入“访问” 
   
   * 单击“保存”  。 这将开始在后台预配表，同时可以开始添加其他列。

3. 创建“计划开始时间”列

   * 选择 Visit 表

   * 确保已选择“列”选项卡，然后单击“添加列” 。
   
   * 为“显示名称”输入“计划开始时间”。
   
   * 为“数据类型”选择“日期和时间”。
   
   * 在“必填”中，选择“必需”。
   
   * 展开“高级选项”部分。
   
   * 在“行为”中，选择“与时区无关”。
   
   * 单击“Done”（完成） 。

4.  创建“计划结束时间”列

    * 单击“添加列”。
    
    * 为“显示名称”输入“计划结束时间”。
    
    * 为“数据类型”选择“日期和时间”。
    
    * 在“必填”中，选择“必需”。
    
    * 展开“高级选项”部分。
    
    * 在“行为”中，选择“与时区无关”。
    
    * 单击“Done”（完成） 。
    
5.  创建“实际开始时间”列

    * 单击“添加列”。
    
    * 为“显示名称”输入“实际开始时间”。
    
    * 为“数据类型”选择“日期和时间”。
    
    * 在“必填”字段中，将其保留为“可选”。
    
    * 展开“高级选项”部分。
    
    * 在“行为”中，选择“与时区无关”。
    
    * 单击“Done”（完成） 。
    
6.  创建“实际结束时间”列

    * 单击“添加列”。
    
    * 为“显示名称”输入“实际结束时间”。
    
    * 为“数据类型”选择“日期和时间”。
    
    * 在“必填”字段中，将其保留为“可选”。
    
    * 展开“高级选项”部分。
    
    * 在“行为”中，选择“与时区无关”。
    
    * 单击“Done”（完成） 。
    
7.  创建代码列

    * 单击“添加列”。
    
    * 为“显示名称”输入“代码”。
    
    * 为“数据类型”选择“自动编号”。
    
    * 为“自动编号类型”选择“带日期前缀的数字”。
    
    * 单击“Done”（完成） 。
    
8.  单击“保存表”

# <a name="exercise-3-create-relationships"></a>练习 \#3：创建关系

**目的：** 在本练习中，你将在表之间添加关系。

## <a name="task-1-create-relationships"></a>任务 #1：创建关系

1.  确保你仍在查看“校园管理”解决方案的“Visit”表。 如果没有，请导航到那里。

2.  创建访问到联系人的关系

    * 选择“关系”选项卡。
    
    * 单击“添加关系”，然后选择“多对一”
    
    * 为“相关(一个)” 选择“联系人” 
    
    * 为“查找列显示名称”输入“访客” 
    
    * 单击“Done”（完成） 。
    
3.  创建访问到建筑物的关系

    * 单击“添加关系”，然后选择“多对一”
    
    * 为“相关（一个）”选择“选择建筑物” 
    
    * 单击“Done”（完成） 。
    
4.  单击“保存表”。

5.  选择左上角的“回到解决方案”。

6.  选择“发布所有自定义”。

# <a name="exercise-4-import-data"></a>练习 \#4：导入数据

**目的：** 在本练习中，你要将示例数据导入 Dataverse 数据库。

## <a name="task-1-import-solution"></a>任务 #1：导入解决方案

在此任务中，你将导入一个包含完成数据导入所需的 Power Automate 流的解决方案。

1. 应在桌面上存储 DataImport_managed.zip 文件。 下载[数据导入解决方案](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/blob/master/Allfiles/DataImport_managed.zip?raw=true)（如果尚未下载）。

2. 登录 <https://make.powerapps.com> 。

3. 如果尚未选择“[我的初始] 练习”环境，请在右上角选择它。

4. 在左侧导航面板中选择“解决方案”。

5. 单击“导入”，然后单击“浏览”。 从你的桌面浏览并选择 **DataImport_managed.zip**，然后按“下一步”。

>   你可能会收到以下消息：
>
>   缺少依赖项。 在安装此解决方案之前，请先安装以下解决方案...
>
>   该消息表明要么数据模型不完整，要么发布者前缀不是“bc”，要么“Building”和“Visit”表名称与上述步骤中列出的名称不同。  

6. 按“下一步”。 系统应该会提示你重新建立连接。 

7. 展开“选择连接”下拉菜单并选择“+ 新建连接”。

8. 新的浏览器窗口或选项卡将打开。 提示进行连接时选择“创建”。 如果需要完成创建连接，请登录。

9. 关闭当前选项卡，立即返回到之前的“导入解决方案”选项卡。

10. 确保已选择刚刚创建的连接。 如果看不到连接，单击“刷新”以刷新连接列表。 

11. 按“导入”。

12. 等待导入完成。

## <a name="task-2-import-data"></a>任务 #2：导入数据  

1. 打开“数据导入”解决方案。

2. 检查“导入数据”流的“状态”。

3. 如果“状态”为“关闭”，请选择“导入数据”旁边的“…”，然后选择“打开”    。

   > **重要提示：** 如果收到错误消息，请验证创建的表和列是否与上面的说明匹配。

4. 打开“导入数据”组件。 一个新的选项卡将打开 Power Automate。 

5. 如果出现弹出窗口，请单击“开始”。 

6. 单击“运行”，然后在提示时单击“运行流”。

7. 单击“Done”（完成） 。

8. 等待流实例完成运行。 你可以刷新 **28 天运行历史记录** 表，以查看流何时运行过。 

    > 该流的目的是为即将进行的实验室生成示例数据。 在下一个任务中，你将验证数据导入是否成功。 

## <a name="task-3-verify-data-import"></a>任务 3：验证数据导入

1. 导航回到上一个 Power Apps 选项卡。在弹出窗口中单击“完成”。 

2. 在左侧导航栏上选择“解决方案”，然后打开你的“校园管理”解决方案。

2. 单击以打开“Visit”表，然后选择“数据”选项卡。

3. 单击右上角的“活动访问”以显示视图选择器，然后选择“所有列”。 这将更改用于显示访问数据的视图。 

    > 如果由于分辨率较低而看不到“活动访问”，你应该会在同一位置看到一个眼睛图标。

    > 如果导入成功，应会显示访问行列表。

4. 单击“建筑物”列中的任意值，确认该“建筑物”表单在单独的窗口中打开。 

5. 关闭最近启动的窗口。

6. 单击“访客”列中的任意值（可能需要向右滚动视图），确认联系人表单在一个单独的窗口中打开。

7. 关闭最近启动的窗口。

# <a name="challenges"></a>挑战

* 你会考虑使用“约定“作为解决方案的一部分吗？ 它会改变什么？
* 如何将计划的结束时间强行安排在计划的开始时间之后？ 
* 你如何在一次访问中添加对多个会议的支持？
* 如何为外部联系人和内部工作人员取得建筑的访问权限？
* 如何使特定建筑物的访问需要管理层批准？ 数据模型中的审批流程会发生什么变化？

